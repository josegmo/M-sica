<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lyrics Player Vallenato Retro Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        /* --- ESTILOS (CSS) --- */
        body {
            background-color: #052610; /* Color Base: Verde Oscuro */
            color: #f7f2c6;
            font-family: 'Press Start 2P', cursive; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            text-align: center;
            overflow: hidden;
            transition: background-color 0.7s ease-in-out; /* Transici√≥n Lenta para el Mood */
        }

        #lyrics-container { min-height: 100px; padding: 20px; width: 90%; display: flex; justify-content: center; align-items: center; }

        #text-display { 
            font-size: 1.4rem; 
            line-height: 2.0;
            text-shadow: 4px 4px 0px #000;
        }

        /* 1. √âNFASIS EN PALABRAS CLAVE (Dorado) */
        .keyword-emphasis {
            color: #ffd700; 
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.7); 
            font-weight: bold;
        }

        /* 2. EFECTO DE MOOD (Coro - Azul Profundo) */
        .chorus-mood { background-color: #0F1F50 !important; }
        
        /* 3. EFECTO DE PULSO (Flash R√°pido - Rojo) */
        .pulse-effect { 
            background-color: #A03030 !important; 
            transition: background-color 0.1s ease-in-out !important; /* M√°s r√°pido que la transici√≥n base */
        }

        /* 4. EFECTO DE TEMBLOR Y ESTELA */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); } 25% { transform: translate(-1px, -2px) rotate(-1deg); }
            50% { transform: translate(-3px, 0px) rotate(1deg); } 75% { transform: translate(3px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -1px) rotate(-1deg); }
        }

        .shake-effect {
            animation: shake 0.2s cubic-bezier(.36,.07,.19,.97) both;
            /* Estela con m√∫ltiples sombras transparentes */
            text-shadow: 
                -4px 0px 0px rgba(247,242,198,0.7), 
                -8px 0px 0px rgba(247,242,198,0.4), 
                -12px 0px 0px rgba(247,242,198,0.2), 
                4px 4px 0px #000;
        }
        
        audio { position: fixed; bottom: 20px; width: 80%; opacity: 0.5; }
    </style>
</head>
<body>
    <div id="lyrics-container">
        <h1 id="text-display">Cargando Silvestre Dangond...</h1>
    </div>
    <audio id="audio-player" controls>
        <source src="Silvestre Dangond - Un Amor Genial (Cover Audio)(M4A_128K).m4a" type="audio/mp4">
        Tu navegador no soporta el formato de audio.
    </audio>
    <script>
        // --- JAVASCRIPT CON ARRANQUE Y SINCRONIZACI√ìN CORREGIDA ---

        // NOTA: Tiempos de sincronizaci√≥n ajustados a +0.8s para compensar latencia
        const lyrics = [
            { time: 1.8, text: "üé∂ Intro Vallenato üé∂" },
            { time: 15.1, text: "Yo no tengo c√≥mo pagarte" },
            { time: 16.8, text: "que te quedes <span class='keyword-emphasis'>conmigo</span>" },
            { time: 18.8, text: "Ah√≠, no alcanzar√≠a la vida" },
            { time: 21.0, text: "para poder contar." },
            { time: 23.6, text: "Que t√∫ nunca has querido a nadie" },
            { time: 25.8, text: "como a m√≠ me has <span class='keyword-emphasis'>querido</span>." },
            { time: 28.6, text: "Por eso te bendigo" },
            { time: 30.8, text: "cada d√≠a m√°s y m√°s" },
            { time: 33.6, text: "¬°Porque t√∫!" },
            { time: 34.4, text: "Porque t√∫ eres muy buena conmigo" },
            { time: 37.0, text: "Porque t√∫ eres muy <span class='keyword-emphasis'>linda</span> conmigo" },
            { time: 40.3, text: "Porque yo te <span class='keyword-emphasis'>amar√≠a</span> hasta el final." },
        ];

        const pulseMoments = [
            { time: 15.8, duration: 0.1 }, { time: 18.3, duration: 0.1 },
            { time: 20.3, duration: 0.1 }, { time: 21.8, duration: 0.1 },
            { time: 30.3, duration: 0.15 }, { time: 33.5, duration: 0.2 }, 
            { time: 34.3, duration: 0.1 }, { time: 36.9, duration: 0.1 },
            { time: 37.8, duration: 0.1 }, { time: 40.8, duration: 0.15 } 
        ];

        const moodChanges = [
            { start: 33.3, end: 43.3, moodClass: 'chorus-mood' },
            { start: 85.8, end: 95.8, moodClass: 'chorus-mood' },
        ];

        const audio = document.getElementById('audio-player');
        const display = document.getElementById('text-display');
        const body = document.body;
        
        /* SOLUCI√ìN: Borrar texto inicial cuando se presiona Play */
        audio.addEventListener('play', () => {
            display.innerHTML = "";
            display.style.display = "block";
        });
        
        audio.addEventListener('timeupdate', () => {
            const currentTime = audio.currentTime;

            // L√ìGICA DE LETRAS
            const currentLine = lyrics.slice().reverse().find(line => currentTime >= line.time);
            if (currentLine && display.innerHTML !== currentLine.text) {
                display.innerHTML = currentLine.text;
                display.style.display = "none";
                setTimeout(() => display.style.display = "block", 10);
            }

            // L√ìGICA DE MOOD
            let moodApplied = false;
            moodChanges.forEach(mood => {
                if (currentTime >= mood.start && currentTime < mood.end) {
                    if (!body.classList.contains(mood.moodClass)) { body.classList.add(mood.moodClass); }
                    moodApplied = true;
                }
            });
            if (!moodApplied && body.classList.contains('chorus-mood')) { body.classList.remove('chorus-mood'); }


            // L√ìGICA DE PULSO Y SHAKE
            pulseMoments.forEach(event => {
                if (currentTime >= event.time && currentTime < event.time + 0.1) {
                    body.classList.add('pulse-effect');
                    display.classList.add('shake-effect');

                    setTimeout(() => {
                        body.classList.remove('pulse-effect');
                        display.classList.remove('shake-effect');
                    }, event.duration * 1000);
                }
            });
        });
    </script>
</body>
</html>
